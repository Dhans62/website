<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bro Exam</title>
    <!-- Memuat Tailwind CSS dan Font Script untuk judul -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Memuat font skrip untuk judul 'Broexam' agar mirip screenshot */
        @import url('https://fonts.googleapis.com/css2?family=Dancing+Script:wght@700&display=swap');
        
        body {
            font-family: sans-serif; /* Font default bersih */
            background-color: #f0f4f8; 
            margin: 0;
            padding: 0;
            overflow: hidden; 
        }
        
        /* Style Judul Broexam */
        #appTitle {
            font-family: 'Dancing Script', cursive;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.2);
            /* Memindahkan judul ke kiri sepenuhnya */
            margin-right: auto; 
        }

        /* Style untuk iframe yang memenuhi seluruh area di bawah header */
        #contentFrame {
            width: 100%;
            /* Tinggi layar dikurangi tinggi header 48px */
            height: calc(100vh - 48px); 
            border: none;
            display: block;
        }

        /* Area rahasia (sekitar ikon kunci/nama aplikasi) */
        #secretZone {
            position: absolute;
            top: 0;
            left: 0;
            width: 100px; /* Area tap tersembunyi di kiri atas */
            height: 48px;
            z-index: 20;
            cursor: pointer;
        }

        /* Styling Progress Bar */
        #progressBarContainer {
            position: absolute;
            top: 48px; /* Tepat di bawah header */
            left: 0;
            width: 100%;
            height: 3px; /* Ketebalan Progress Bar */
            background-color: transparent; /* Latar belakang transparan */
            z-index: 15; /* Di atas iframe */
        }
        
        #progressBar {
            height: 100%;
            width: 0%; /* Dimulai dari 0 */
            background-color: #fca5a5; /* Warna pink/merah muda, agar kontras */
            transition: width 0.3s ease-out; /* Animasi perpindahan yang halus */
        }
    </style>
</head>
<body class="h-screen w-screen overflow-hidden">

    <!-- Header Status Bar - Warna Biru Tua (#3949AB) -->
    <header id="appHeader" class="flex justify-between items-center h-12 px-4 text-white shadow-xl relative z-10" style="background-color: #3949AB;">
        
        <!-- Area rahasia untuk keluar/masuk mode kunci (Ketuk 5x) -->
        <div id="secretZone" title="Ketuk 5x untuk Kunci/Buka Kunci"></div>

        <!-- Nama Aplikasi/Judul (Kiri) -->
        <h1 id="appTitle" class="text-3xl font-extrabold italic">
            Broexam
        </h1>

        <!-- Status Baterai dan Jam (Tengah) -->
        <div class="flex items-center space-x-3 text-lg font-semibold">
            <span id="batteryStatus" class="flex items-center">
                <!-- Ikon Baterai (Placeholder SVG sederhana) -->
                <svg id="batteryIcon" class="w-6 h-6 mr-1" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
                    <path d="M12 4h1a2 2 0 012 2v8a2 2 0 01-2 2h-1v-2h1V6h-1a1 1 0 00-1-1H7a1 1 0 00-1 1v8H5v-2H6a2 2 0 012 2h1a1 1 0 011 1v1h2v-1a1 1 0 011-1h1a2 2 0 01-2-2V6a2 2 0 012-2zM8 6h4v8H8V6z" clip-rule="evenodd" fill-rule="evenodd"></path>
                </svg>
                <span id="batteryLevel">84%</span>
            </span>
            <!-- Ikon Jam -->
            <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm1-12a1 1 0 10-2 0v4a1 1 0 00.293.707l3 3a1 1 0 001.414-1.414L11 9.586V6z" clip-rule="evenodd"></path></svg>
            <span id="currentTime">16:48</span>
        </div>

        <!-- Kontrol (Kanan: Refresh & Tutup) -->
        <div class="flex items-center space-x-4 ml-auto">
            <!-- Refresh Icon -->
            <button id="refreshBtn" class="p-1 focus:outline-none hover:text-gray-300 transition duration-150" title="Muat Ulang Halaman">
                <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.975 8.975 0 0120 13a9 9 0 11-8-9v5H4"></path></svg>
            </button>
            <!-- Close Icon -->
            <button id="closeBtn" class="p-1 focus:outline-none hover:text-red-300 transition duration-150" title="Keluar/Buka Kunci">
                <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg>
            </button>
        </div>
    </header>
    
    <!-- Progress Bar Container -->
    <div id="progressBarContainer">
        <div id="progressBar"></div>
    </div>

    <!-- Konten Utama: Iframe Browser -->
    <iframe id="contentFrame" src="http://172.16.10.1/" allowfullscreen></iframe>

    <script>
        const contentFrame = document.getElementById('contentFrame');
        const appHeader = document.getElementById('appHeader');
        const batteryLevelSpan = document.getElementById('batteryLevel');
        const currentTimeSpan = document.getElementById('currentTime');
        const secretZone = document.getElementById('secretZone');
        const refreshBtn = document.getElementById('refreshBtn');
        const closeBtn = document.getElementById('closeBtn');
        const progressBar = document.getElementById('progressBar');

        let tapCount = 0;
        let lastTapTime = 0;
        const TAP_THRESHOLD = 500; // 500ms antar ketukan
        const REQUIRED_TAPS = 5; // Jumlah ketukan rahasia

        // ===================================
        // Logika Progress Bar
        // ===================================

        // Fungsi untuk memulai animasi progress bar
        function startLoading() {
            progressBar.style.width = '10%'; // Mulai cepat
            progressBar.style.opacity = '1';
            
            // Animasi untuk mencapai 80% (simulasi loading)
            let currentWidth = 10;
            const interval = setInterval(() => {
                currentWidth += 5; // Peningkatan simulasi
                if (currentWidth >= 80) {
                    clearInterval(interval);
                    currentWidth = 80;
                }
                progressBar.style.width = `${currentWidth}%`;
            }, 300); // Bergerak setiap 300ms
            
            contentFrame.loadingInterval = interval; // Simpan interval untuk dihentikan
        }

        // Fungsi untuk menyelesaikan/menyembunyikan progress bar
        function finishLoading() {
            if (contentFrame.loadingInterval) {
                clearInterval(contentFrame.loadingInterval);
            }
            
            progressBar.style.width = '100%'; // Selesaikan
            // Sembunyikan setelah transisi selesai
            setTimeout(() => {
                progressBar.style.opacity = '0';
                progressBar.style.width = '0%';
            }, 500); // 500ms setelah selesai
        }
        
        // Listener saat iframe selesai memuat
        contentFrame.addEventListener('load', () => {
             finishLoading();
        });

        // ===================================
        // Logika Kunci Layar Rahasia (Full Screen API)
        // ===================================
        function isLocked() {
            return document.fullscreenElement || document.webkitFullscreenElement || document.mozFullScreenElement || document.msFullscreenElement;
        }

        function lockScreen() {
            const element = document.documentElement;
            if (element.requestFullscreen) {
                element.requestFullscreen();
            } else if (element.webkitRequestFullscreen) {
                element.webkitRequestFullscreen();
            } else if (element.msRequestFullscreen) {
                element.msRequestFullscreen();
            }
            // Sembunyikan header saat terkunci
            appHeader.style.display = 'none';
        }

        function unlockScreen() {
            if (document.exitFullscreen) {
                document.exitFullscreen();
            } else if (document.webkitExitFullscreen) {
                document.webkitExitFullscreen();
            } else if (document.msExitFullscreen) {
                document.msExitFullscreen();
            }
            // Tampilkan kembali header
            appHeader.style.display = 'flex';
        }
        
        // Listener untuk Area Rahasia (Secret Zone)
        secretZone.addEventListener('click', () => {
            const now = Date.now();
            
            if (now - lastTapTime > TAP_THRESHOLD) {
                tapCount = 1;
            } else {
                tapCount++;
            }
            
            lastTapTime = now;

            if (tapCount === REQUIRED_TAPS) {
                if (isLocked()) {
                    unlockScreen();
                } else {
                    lockScreen();
                }
                tapCount = 0; 
            }
        });

        // Listener untuk Tombol Tutup (Sama dengan toggle lock)
        closeBtn.addEventListener('click', () => {
            if (isLocked()) {
                unlockScreen();
            } else {
                lockScreen();
            }
        });

        // Listener untuk Tombol Refresh
        refreshBtn.addEventListener('click', () => {
            startLoading(); // Mulai simulasi loading
            // Memuat ulang halaman di dalam iframe
            contentFrame.contentWindow.location.reload(); 
        });


        // ===================================
        // Pembaruan Status Baterai & Waktu
        // ===================================
        function updateBatteryStatus(battery) {
            const level = Math.round(battery.level * 100);
            batteryLevelSpan.textContent = `${level}%`;
        }

        if ('getBattery' in navigator) {
            navigator.getBattery().then(battery => {
                updateBatteryStatus(battery);
                battery.addEventListener('levelchange', () => updateBatteryStatus(battery));
            }).catch(e => {
                batteryLevelSpan.textContent = 'Baterai';
            });
        } else {
            batteryLevelSpan.textContent = '84%';
        }

        function updateTime() {
            const now = new Date();
            const hours = String(now.getHours()).padStart(2, '0');
            const minutes = String(now.getMinutes()).padStart(2, '0');
            currentTimeSpan.textContent = `${hours}:${minutes}`;
        }
        
        updateTime();
        setInterval(updateTime, 60000);

        // ===================================
        // Setup Awal
        // ===================================
        document.addEventListener('fullscreenchange', () => {
            if (!isLocked()) {
                appHeader.style.display = 'flex';
            }
        });

        window.onload = function() {
            // Sembunyikan progress bar di awal (karena iframe mungkin sudah selesai loading)
            progressBar.style.opacity = '0'; 
            
            // Penyesuaian tinggi iframe
            const adjustIframeHeight = () => {
                contentFrame.style.height = `calc(100vh - ${appHeader.offsetHeight}px)`;
            }
            adjustIframeHeight();
            window.addEventListener('resize', adjustIframeHeight);
        };
    </script>
</body>
</html>
