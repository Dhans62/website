<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Broexam</title>

<script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Memuat font skrip untuk judul 'Broexam' agar mirip screenshot */
        @import url('https://fonts.googleapis.com/css2?family=Dancing+Script:wght@700&display=swap');
        
        body {
            font-family: sans-serif; /* Font default bersih */
            background-color: #f0f4f8; 
            margin: 0;
            padding: 0;
            overflow: hidden; 
        }
        
        /* Style Judul Broexam */
        #appTitle {
            font-family: 'Dancing Script', cursive; /* Menggunakan font Dancing Script */
            text-shadow: 1px 1px 2px rgba(0,0,0,0.2);
            font-weight: 700; /* Tebalkan untuk lebih mirip */
            font-size: 2.25rem; /* Ukuran font lebih besar */
            line-height: 2.5rem; /* Tinggi baris */
            margin-right: auto; 
            margin-left: -0.5rem; /* Geser sedikit ke kiri untuk estetika */
        }

        /* Style untuk iframe yang memenuhi seluruh area di bawah header */
        #contentFrame {
            width: 100%;
            /* Tinggi layar dikurangi tinggi header 48px */
            height: calc(100vh - 48px); 
            border: none;
            display: block;
        }

        /* Area rahasia (sekitar ikon kunci/nama aplikasi) */
        #secretZone {
            position: absolute;
            top: 0;
            left: 0;
            width: 100px; /* Area tap tersembunyi di kiri atas */
            height: 48px;
            z-index: 20;
            cursor: pointer;
        }

        /* Styling Progress Bar */
        #progressBarContainer {
            position: absolute;
            top: 48px; /* Tepat di bawah header */
            left: 0;
            width: 100%;
            height: 3px; /* Ketebalan Progress Bar */
            background-color: transparent; /* Latar belakang transparan */
            z-index: 15; /* Di atas iframe */
        }
        
        #progressBar {
            height: 100%;
            width: 0%; /* Dimulai dari 0 */
            background-color: #fca5a5; /* Warna pink/merah muda, agar kontras */
            transition: width 0.3s ease-out; /* Animasi perpindahan yang halus */
        }
    </style>
</head>
<body class="h-screen w-screen overflow-hidden">

    <!-- Header Status Bar - Warna Biru Tua (#3949AB) -->
    <header id="appHeader" class="flex items-center h-12 px-4 text-white shadow-xl relative z-10" style="background-color: #3949AB;">
        
        <!-- Area rahasia untuk keluar/masuk mode kunci (Ketuk 5x) -->
        <div id="secretZone" title="Ketuk 5x untuk Kunci/Buka Kunci"></div>

        <!-- Nama Aplikasi/Judul (Kiri) -->
        <h1 id="appTitle" class="text-3xl font-extrabold italic">
            Broexam
        </h1>

        <!-- Grup Status (Baterai & Jam) - Ditempatkan paling kanan dengan ml-auto -->
        <div class="flex items-center space-x-3 text-lg font-semibold ml-auto">
            
            <!-- Persentase Baterai (TANPA IKON) -->
            <span id="batteryStatus" class="flex items-center">
                <span id="batteryLevel">77%</span>
            </span>
            
            <!-- Ikon Jam (Diambil dari referensi terbaru) -->
            <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8zm.5-13H11v6l5.25 3.15.75-1.23-4.5-2.67zM17.5 4L22 7l-1.5 1L16 5.5l1.5-1zM6.5 4L2 7l1.5 1L8 5.5l-1.5-1z"/>
            </svg>
            <span id="currentTime">17:33</span>
        </div>

        <!-- Kontrol (Refresh & Tutup) - Ditempatkan setelah grup status -->
        <div class="flex items-center space-x-2"> 
            <!-- Refresh Icon (Posisi di tengah antara Jam dan X) -->
            <button id="refreshBtn" class="p-1 focus:outline-none hover:text-gray-300 transition duration-150" title="Muat Ulang Halaman">
                <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                    <path d="M17.65 6.35C16.2 4.9 14.21 4 12 4c-4.42 0-7.99 3.58-7.99 8s3.57 8 7.99 8c3.73 0 6.84-2.55 7.73-6h-2.08c-.82 2.33-3.04 4-5.65 4-3.31 0-6-2.69-6-6s2.69-6 6-6c1.76 0 3.3.73 4.46 1.99L13 11h7V4l-2.35 2.35z"/>
                </svg>
            </button>
            <!-- Close Icon -->
            <button id="closeBtn" class="p-1 focus:outline-none hover:text-red-300 transition duration-150" title="Keluar/Buka Kunci">
                <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg>
            </button>
        </div>
    </header>
    
    <!-- Progress Bar Container -->
    <div id="progressBarContainer">
        <div id="progressBar"></div>
    </div>

    <!-- Konten Utama: Iframe Browser -->
    <iframe id="contentFrame" src="http://172.16.10.1/" allowfullscreen></iframe>

    <script>
        const contentFrame = document.getElementById('contentFrame');
        const appHeader = document.getElementById('appHeader');
        const batteryLevelSpan = document.getElementById('batteryLevel');
        const currentTimeSpan = document.getElementById('currentTime');
        const secretZone = document.getElementById('secretZone');
        const refreshBtn = document.getElementById('refreshBtn');
        const closeBtn = document.getElementById('closeBtn');
        const progressBar = document.getElementById('progressBar');
        // const batteryIcon = document.getElementById('batteryIcon'); // Dihapus

        let tapCount = 0;
        let lastTapTime = 0;
        const TAP_THRESHOLD = 500; 
        const REQUIRED_TAPS = 5; 

        // ===================================
        // Logika Progress Bar
        // ===================================

        function startLoading() {
            progressBar.style.width = '10%';
            progressBar.style.opacity = '1';
            
            let currentWidth = 10;
            const interval = setInterval(() => {
                currentWidth += 5;
                if (currentWidth >= 80) {
                    clearInterval(interval);
                    currentWidth = 80;
                }
                progressBar.style.width = `${currentWidth}%`;
            }, 300);
            
            contentFrame.loadingInterval = interval;
        }

        function finishLoading() {
            if (contentFrame.loadingInterval) {
                clearInterval(contentFrame.loadingInterval);
            }
            
            progressBar.style.width = '100%';
            setTimeout(() => {
                progressBar.style.opacity = '0';
                progressBar.style.width = '0%';
            }, 500);
        }
        
        contentFrame.addEventListener('load', () => {
             finishLoading();
        });

        // ===================================
        // Logika Kunci Layar Rahasia (Full Screen API)
        // ===================================
        function isLocked() {
            return document.fullscreenElement || document.webkitFullscreenElement || document.mozFullScreenElement || document.msFullscreenElement;
        }

        function lockScreen() {
            const element = document.documentElement;
            if (element.requestFullscreen) {
                element.requestFullscreen();
            } else if (element.webkitRequestFullscreen) {
                element.webkitRequestFullscreen();
            } else if (element.msRequestFullscreen) {
                element.msRequestFullscreen();
            }
            appHeader.style.display = 'none';
        }

        function unlockScreen() {
            if (document.exitFullscreen) {
                document.exitFullscreen();
            } else if (document.webkitExitFullscreen) {
                document.webkitExitFullscreen();
            } else if (document.msExitFullscreen) {
                document.msExitFullscreen();
            }
            appHeader.style.display = 'flex';
        }
        
        secretZone.addEventListener('click', () => {
            const now = Date.now();
            
            if (now - lastTapTime > TAP_THRESHOLD) {
                tapCount = 1;
            } else {
                tapCount++;
            }
            
            lastTapTime = now;

            if (tapCount === REQUIRED_TAPS) {
                if (isLocked()) {
                    unlockScreen();
                } else {
                    lockScreen();
                }
                tapCount = 0; 
            }
        });

        closeBtn.addEventListener('click', () => {
            if (isLocked()) {
                unlockScreen();
            } else {
                lockScreen();
            }
        });

        refreshBtn.addEventListener('click', () => {
            startLoading();
            contentFrame.contentWindow.location.reload(); 
        });


        // ===================================
        // Pembaruan Status Baterai & Waktu
        // ===================================
        function updateBatteryStatus(battery) {
            const level = Math.round(battery.level * 100);
            batteryLevelSpan.textContent = `${level}%`;
        }

        if ('getBattery' in navigator) {
            navigator.getBattery().then(battery => {
                updateBatteryStatus(battery);
                battery.addEventListener('levelchange', () => updateBatteryStatus(battery));
            }).catch(e => {
                batteryLevelSpan.textContent = '77%'; // Fallback jika tidak bisa mendapatkan status baterai
            });
        } else {
            batteryLevelSpan.textContent = '77%'; // Default
        }


        function updateTime() {
            const now = new Date();
            const hours = String(now.getHours()).padStart(2, '0');
            const minutes = String(now.getMinutes()).padStart(2, '0');
            currentTimeSpan.textContent = `${hours}:${minutes}`;
        }
        
        updateTime();
        setInterval(updateTime, 60000);

        // ===================================
        // Setup Awal
        // ===================================
        document.addEventListener('fullscreenchange', () => {
            if (!isLocked()) {
                appHeader.style.display = 'flex';
            }
        });

        window.onload = function() {
            progressBar.style.opacity = '0'; 
            
            const adjustIframeHeight = () => {
                contentFrame.style.height = `calc(100vh - ${appHeader.offsetHeight}px)`;
            }
            adjustIframeHeight();
            window.addEventListener('resize', adjustIframeHeight);
        };
    </script>
</body>
</html>
